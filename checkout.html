<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Checkout</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: lightblue;
      margin: 0;
      padding: 2rem;
      box-sizing: border-box;
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 1rem;
      font-size: 1.8rem;
    }

    .wrap {
      max-width: 960px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      align-items: start;
    }

    .card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      padding: 20px;
    }

    .card h2 {
      margin: 0 0 12px 0;
      font-size: 1.1rem;
      color: #2c3e50;
    }

    label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      color: #2c3e50;
      font-size: 0.95rem;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    select,
    textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 6px;
      border: 1px solid #ccd6dd;
      font-size: 0.95rem;
      margin-bottom: 14px;
      box-sizing: border-box;
    }

    textarea {
      min-height: 80px;
      resize: vertical;
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #2980b9;
      box-shadow: 0 0 6px rgba(41,128,185,0.15);
    }

    .place-order-row {
      grid-column: 1 / -1;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 20px;
      margin-top: 12px;
    }

    .summary {
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      flex: 1;
    }

    .summary p {
      margin: 6px 0;
      font-size: 0.95rem;
      color: #2c3e50;
    }

    .order-btn {
      background-color: #27ae60;
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      font-size: 1rem;
      box-shadow: 0 6px 14px rgba(39,174,96,0.2);
    }

    .order-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .back-link {
      display: inline-block;
      margin-top: 12px;
      color: #2980b9;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.95rem;
    }

    .back-link:hover { text-decoration: underline; }

    .confirmation {
      max-width: 700px;
      margin: 18px auto 0;
      background: #fff;
      border-radius: 10px;
      padding: 18px;
      box-shadow: 0 8px 22px rgba(0,0,0,0.08);
      display: none;
    }

    .confirmation h3 {
      margin: 0 0 8px 0;
      color: #2c3e50;
    }

    .muted {
      color: #55606a;
      font-size: 0.95rem;
    }

    @media (max-width: 860px) {
      .wrap { grid-template-columns: 1fr; }
      .place-order-row { flex-direction: column-reverse; align-items: stretch; }
      .summary { margin-top: 0; }
    }
  </style>
</head>
<body>
  <h1>Checkout</h1>

  <div class="wrap">
    <!-- Person Details -->
    <div class="card" id="personCard">
      <h2>Person Details</h2>
      <form id="checkoutForm" autocomplete="on">
        <label for="fullName">Full Name</label>
        <input id="fullName" name="fullName" type="text" placeholder="e.g. John Doe" required />

        <label for="email">Email</label>
        <input id="email" name="email" type="email" placeholder="you@example.com" required />

        <label for="phone">Phone Number</label>
        <input id="phone" name="phone" type="tel" placeholder="+91 98765 43210" pattern="[0-9+\-\s()]{7,20}" required />

        <label for="address">Address</label>
        <textarea id="address" name="address" placeholder="Street, City, State, Pincode" required></textarea>
      </form>
    </div>

    <!-- Card Details -->
    <div class="card" id="cardCard">
      <h2>Card Details</h2>

      <label for="cardNumber">Card Number</label>
      <input id="cardNumber" name="cardNumber" type="text" inputmode="numeric" maxlength="19" placeholder="1234 5678 9012 3456" required />

      <div style="display:flex; gap:10px;">
        <div style="flex:1;">
          <label for="expMonth">Expiry Month</label>
          <select id="expMonth" required>
            <option value="">Month</option>
            <option value="01">01 - Jan</option><option value="02">02 - Feb</option>
            <option value="03">03 - Mar</option><option value="04">04 - Apr</option>
            <option value="05">05 - May</option><option value="06">06 - Jun</option>
            <option value="07">07 - Jul</option><option value="08">08 - Aug</option>
            <option value="09">09 - Sep</option><option value="10">10 - Oct</option>
            <option value="11">11 - Nov</option><option value="12">12 - Dec</option>
          </select>
        </div>

        <div style="flex:1;">
          <label for="expYear">Expiry Year</label>
          <select id="expYear" required>
            <option value="">Year</option>
          </select>
        </div>
      </div>

      <div style="display:flex; gap:10px;">
        <div style="flex:1;">
          <label for="cvv">CVV</label>
          <input id="cvv" name="cvv" type="password" inputmode="numeric" maxlength="4" placeholder="123" required />
        </div>

        <div style="flex:1;">
          <label for="cardName">Name on Card</label>
          <input id="cardName" name="cardName" type="text" placeholder="Name as on card" required />
        </div>
      </div>

      <a class="back-link" href="cart.html">‚Üê Back to Cart</a>
    </div>

    <!-- Place Order -->
    <div class="place-order-row">
      <div class="summary">
        <p class="muted"><strong>Order summary:</strong></p>
        <p id="orderTotal" class="muted">Total: ‚Çπ0</p>
        <p id="orderItems" class="muted"></p>
      </div>

      <div style="min-width:220px; display:flex; align-items:center; justify-content:flex-end;">
        <button id="placeOrderBtn" class="order-btn" type="button">Place Order</button>
      </div>
    </div>
  </div>

  <!-- Confirmation Section -->
  <div class="confirmation" id="confirmation">
    <h3>Order Confirmed</h3>
    <p id="confirmMsg" class="muted"></p>
    <p id="confirmDetails" class="muted"></p>
    <p style="margin-top:12px;"><a class="back-link" href="brandhome.html">Continue Shopping</a></p>
  </div>

  <script>
    // Populate expiry year dropdown
    (function populateYears() {
      const yearSelect = document.getElementById('expYear');
      const now = new Date();
      const start = now.getFullYear();
      for (let i = 0; i <= 12; i++) {
        const y = start + i;
        const opt = document.createElement('option');
        opt.value = String(y);
        opt.textContent = String(y);
        yearSelect.appendChild(opt);
      }
    })();

    // Format card number
    const cardNumberInput = document.getElementById('cardNumber');
    cardNumberInput.addEventListener('input', function (e) {
      let v = e.target.value.replace(/\D/g, '').slice(0, 16);
      v = v.match(/.{1,4}/g);
      e.target.value = v ? v.join(' ') : '';
    });

    // Load cart summary
    function loadCartSummary() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      let total = 0;
      const lines = [];
      cart.forEach(it => {
        lines.push(`${it.name} x${it.quantity || 1} ‚Äî ‚Çπ${it.price}`);
        total += (it.price || 0) * (it.quantity || 1);
      });
      document.getElementById('orderItems').textContent = cart.length ? lines.join('\n') : 'No items in cart';
      document.getElementById('orderTotal').textContent = 'Total: ‚Çπ' + total;
    }
    loadCartSummary();

    // Validation
    function validateForm() {
      const formFields = ['fullName','email','phone','address','cardNumber','expMonth','expYear','cvv','cardName'];
      for (const id of formFields) {
        const el = document.getElementById(id);
        if (!el || !el.value.trim()) {
          el.focus();
          return false;
        }
      }

      const digits = cardNumberInput.value.replace(/\s/g, '');
      if (!/^\d{13,16}$/.test(digits)) {
        cardNumberInput.focus();
        return false;
      }

      const cvv = document.getElementById('cvv').value.trim();
      if (!/^\d{3,4}$/.test(cvv)) {
        document.getElementById('cvv').focus();
        return false;
      }

      const month = document.getElementById('expMonth').value;
      const year = document.getElementById('expYear').value;
      if (!month || !year) return false;

      const exp = new Date(Number(year), Number(month) - 1, 1);
      const now = new Date();
      exp.setMonth(exp.getMonth() + 1);
      exp.setDate(0);
      if (exp < now) return false;

      return true;
    }

    // Generate order ID
    function genOrderId() {
      return 'ORD' + Date.now().toString(36).toUpperCase().slice(3);
    }

    // Handle Place Order
    document.getElementById('placeOrderBtn').addEventListener('click', function () {
      if (!validateForm()) {
        const btn = this;
        btn.disabled = true;
        btn.style.transform = 'translateY(-2px)';
        setTimeout(() => { btn.style.transform = ''; btn.disabled = false; }, 200);
        return;
      }

      // ‚úÖ Alert message when order placed
      alert("üéâ Your order has been placed successfully!");

      const name = document.getElementById('fullName').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const address = document.getElementById('address').value.trim();
      const cardNum = document.getElementById('cardNumber').value.replace(/\s/g, '');
      const maskedCard = '**** **** **** ' + cardNum.slice(-4);

      localStorage.removeItem('cart');

      document.querySelector('.wrap').style.display = 'none';
      const conf = document.getElementById('confirmation');
      conf.style.display = 'block';

      const orderId = genOrderId();
      const totalText = document.getElementById('orderTotal').textContent || '';

      const msg = `Thank you, ${name}! Your order has been placed successfully.`;
      const details = [
        `Order ID: ${orderId}`,
        totalText,
        `Shipping to: ${address}`,
        `Contact: ${phone} ‚Ä¢ ${email}`,
        `Paid with: ${maskedCard} (${document.getElementById('cardName').value.trim()})`
      ];

      document.getElementById('confirmMsg').textContent = msg;
      document.getElementById('confirmDetails').innerText = details.join('\n');
    });
  </script>
</body>
</html>
